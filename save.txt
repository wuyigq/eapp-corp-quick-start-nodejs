
let analysisAttendances = function(attendances) {
    let collect = {}
    for (let userId in attendances) {
        collect[userId] = {MorningNoSign:[], Late:[], SeriousLate:[], Absenteeism:[], EveningNoSign:[], Early:[], overtimes:0, overtime:0}
        for (let info of attendances[userId]) {
            let date = new Date(info.workDate)
            let day = date.getDate()
            if (info.checkType == "OnDuty") {
                if (info.timeResult == "NotSigned") {
                    collect[userId].MorningNoSign.push(day)
                } else if (info.timeResult == "Late" || info.timeResult == "SeriousLate") {
                    let diff = info.userCheckTime - info.baseCheckTime
                    //TODO 9:40，10：30，14：00算迟到
                    if (diff > 600000) collect[userId][info.timeResult].push({day:diff})
                } else if (info.timeResult == "Absenteeism") {
                    collect[userId].Absenteeism.push(day)
                }
            } else {
                if (info.timeResult == "NotSigned") {
                    collect[userId].EveningNoSign.push(day)
                } else if (info.timeResult == "Early") {
                    collect[userId].Early.push(day)
                } else if (info.timeResult == "Absenteeism") {
                    collect[userId].Absenteeism.push(day)
                } else if (info.timeResult == "Normal") {
                    //20：30算加班--2*60*60*1000
                    let diff = info.userCheckTime - info.baseCheckTime
                    if (diff >= 7200000) {
                        if (collect[userId].overtimes) collect[userId].overtimes++
                        else collect[userId].overtimes = 1

                        let length = diff / 60000 //unit(minite)
                        if (collect[userId].overtime) collect[userId].overtime += length
                        else collect[userId].overtime = length
                    }
                }
            }
        }
    }
    return collect
}
